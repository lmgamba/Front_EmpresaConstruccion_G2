<div class="dashboard-container">
  <main class="main-content">
    <header class="topbar">
      <h1>Dashboard Overview</h1>

      <div class="topbar-actions">
        <button class="btn primary" routerLink="/dashboard_admin/constructions">
          + New Project
        </button>

        <div class="profile">
          <div class="avatar">{{ currentUser()?.name?.[0] }}{{ currentUser()?.surname?.[0] }}</div>
        </div>
      </div>
    </header>

    <section class="metrics">
      @for (metric of metrics(); track metric.title) {
        <div class="metric-card">
          <div class="metric-title">{{ metric.title }}</div>
          <div class="metric-value">{{ metric.value }}</div>
          <div class="metric-sub">{{ metric.subtext }}</div>
        </div>
      }
    </section>

    <section class="content-grid">
      <div class="content-center">
        <div class="card map-card">
          <div class="card-header">
            <h3>Project Locations</h3>
            <span class="link">View Full Map</span>
          </div>
          <div class="map-placeholder">
            <span>Active Sites: {{ allConstructions().length }}</span>
          </div>
        </div>

        <div class="card projects-card">
          <div class="card-header">
            <h3>Active Projects Status</h3>
          </div>

          <table class="projects-table">
            <thead>
              <tr>
                <th>Project</th>
                <th>Address</th>
                <th>Workers</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              @for (project of projectsWithStats(); track project.id_constructions) {
                <tr>
                  <td>
                    <strong>{{ project.name }}</strong>
                  </td>
                  <td>{{ project.address }}</td>
                  <td>
                    <div class="progress-bar">
                      <div class="progress" [style.width.%]="project.completion"></div>
                    </div>
                    <span class="percent"> {{ project.workerCount }} Assigned </span>
                  </td>
                  <td>
                    <span class="status on-track">Active</span>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>

      <div class="content-side">
        <div class="card workers">
          <div class="card-header">
            <h3>Staff Overview</h3>
          </div>
          <workers-list [ArrayUsers]="allWorkers()"></workers-list>
        </div>

        <div class="card feed-card">
          <div class="card-header">
            <h3>Latest Activity</h3>
          </div>
          <div class="feed-list">
            @for (item of feed(); track item.id) {
              <div class="feed-item">
                <div class="feed-time">{{ item.time }}</div>
                <div class="feed-message">{{ item.message }}</div>
              </div>
            }
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
